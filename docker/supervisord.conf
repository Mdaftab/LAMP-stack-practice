; =============================================================================
; Supervisor Configuration File
; =============================================================================
; Supervisor is a process manager that allows us to run multiple services
; (Apache and MySQL) inside a single Docker container.
;
; Why do we need this?
; - Docker containers are designed to run ONE process
; - LAMP requires TWO services: Apache (web server) and MySQL (database)
; - Supervisor acts as the "init system" managing both processes
; =============================================================================

[supervisord]
; Run supervisor in the foreground (required for Docker)
nodaemon=true
; Log file location
logfile=/var/log/supervisor/supervisord.log
; Process ID file
pidfile=/var/run/supervisord.pid
; Log level (debug, info, warn, error, critical)
loglevel=info

; =============================================================================
; Apache Web Server Configuration
; =============================================================================
[program:apache2]
; Command to start Apache in foreground mode
; -D FOREGROUND prevents Apache from daemonizing (going to background)
command=/usr/sbin/apache2ctl -D FOREGROUND
; Start automatically when supervisor starts
autostart=true
; Restart if Apache crashes
autorestart=true
; Where to send Apache's stdout
stdout_logfile=/var/log/apache2/access.log
; Where to send Apache's stderr  
stderr_logfile=/var/log/apache2/error.log
; User to run Apache as
user=root

; =============================================================================
; MySQL Database Server Configuration
; =============================================================================
[program:mysql]
; Command to start MySQL
; --user=mysql runs MySQL as the mysql user (security best practice)
command=/usr/bin/mysqld_safe --user=mysql
; Start automatically when supervisor starts
autostart=true
; Restart if MySQL crashes
autorestart=true
; Where to send MySQL's stdout
stdout_logfile=/var/log/mysql/mysql.log
; Where to send MySQL's stderr
stderr_logfile=/var/log/mysql/error.log
; User to run the mysqld_safe wrapper as
user=root
